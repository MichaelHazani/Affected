"use strict";$(function(){function e(){var e=new XMLHttpRequest;e.open("GET",l,!0),e.responseType="arraybuffer",e.onload=function(){var t=e.response;n(t)},e.send()}function n(e){var n;s=r.createBufferSource(),s.loop=!0,r.decodeAudioData(e,function(e){s.buffer=e,n=r.createConvolver(),f=r.createGain(),s.connect(n),n.connect(f),f.connect(r.destination),i(g,n,o)})}function t(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({audio:!0,video:!1},function(e){p=r.createMediaStreamSource(e);var n=r.createConvolver();p.connect(n),n.connect(r.destination),i(g,n)},function(e){alert("Error capturing audio.")})}function o(){s.start(0,h)}function a(){s.stop(),h+=r.currentTime}function i(e,n,t){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(){r.decodeAudioData(o.response,function(e){n.buffer=e,t()})},o.send()}var r=new window.AudioContext,c,s,u=!1,d=!1,l="audio/piano_sample.ogg",g="audio/IR/EMT 28 Echo Plate.wav",v,f,p,h=0;$(document).keypress(function(e){61==e.charCode?(f.gain.value+=.1,console.log(e.charCode)):45==e.charCode&&(f.gain.value-=.1)}),$(".inToggle").click(function(n){console.log(n.target.innerText),"Live Input"!==n.target.innerText||d?"Live Input"===n.target.innerText&&d?($(this).removeClass("switched"),d=!1,p.disconnect()):"Short Clip"!==n.target.innerText||u?"Short Clip"===n.target.innerText&&u?($(this).removeClass("switched"),u=!1,a()):"-"===n.target.innerText?f.gain.value-=.1:"+"===n.target.innerText&&(f.gain.value+=.1):($(this).addClass("switched"),u=!0,e()):($(this).addClass("switched"),d=!0,t())}),$("#subIR").submit(function(n){n.preventDefault(),g="audio/IR/"+$('select[name="IRs"] option:selected').val(),console.log(g),$("select[name='IRs']").blur(),d?(p.disconnect(),t()):u&&(a(),e())})});